// Generate boundary conditions.
Vh[int] bcs(2 * nbc);
for (int j = mpirank; j < nbc; j += mpisize) {
  bcs[j] = sin( (nbc - j) * atan2(y, x) ) / sqrt( pi );
  bcs[j + nbc] = cos( ( j + 1 ) * atan2(y, x) ) / sqrt( pi );
}

for (int j = 0; j < nbc; j++) {
  int rnk = j % mpisize;
  broadcast(processor(rnk), bcs[j][]);
  broadcast(processor(rnk), bcs[j + nbc][]);
}
